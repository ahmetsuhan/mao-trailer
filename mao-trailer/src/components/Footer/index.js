import React, { useEffect, useState } from "react";
import { useSelector } from "react-redux";
import { useHistory, useRouteMatch } from "react-router-dom";
import "../../styles/Footer.style.scss";

const Footer = () => {
  const [movieActive, setMovieActive] = useState(false);
  const [tvActive, setTvActive] = useState(false);
  const [profileActive, setProfileActive] = useState(false);

  const loggedUser = useSelector((state) => state.user.currentUser);
  const history = useHistory();
  const { path } = useRouteMatch();

  useEffect(() => {
    handleFirstSelected(path);
  });

  const handleFirstSelected = (pathname) => {
    switch (pathname) {
      case "/movies":
        setAllFalse();
        setMovieActive(true);
        break;

      case "/tv":
        setAllFalse();
        setTvActive(true);
        break;
      case "/profile/:id":
        setAllFalse();
        setProfileActive(true);
        break;
      default:
        break;
    }
  };

  const handleClick = (e) => {
    const target = e.target;
    const targetOuterDiv = target.parentElement.parentElement;
    const outer = targetOuterDiv.parentElement;

    if (!outer.classList.contains("menubar")) {
      return;
    }
    setAllFalse();
    if (targetOuterDiv.classList.contains("movies-tab")) {
      setMovieActive(true);
      history.push("/movies");
    }

    if (targetOuterDiv.classList.contains("tv-tab")) {
      setTvActive(true);
      history.push("/tv");
    }

    if (targetOuterDiv.classList.contains("profile-tab")) {
      setProfileActive(true);
      let logged = loggedUser ?? {};

      if (Object.keys(logged).length === 0) {
        history.push("/profile/login");
      } else {
        history.push(`/profile/${logged.id.value}`);
      }
    }
  };

  const setAllFalse = () => {
    setProfileActive(false);
    setTvActive(false);
    setMovieActive(false);
  };

  return (
    <footer className="footer">
      <div className="menubar" onClick={(e) => handleClick(e)}>
        <div className="movies-tab">
          <svg
            width="125"
            height="49"
            viewBox="0 0 125 49"
            fill={movieActive ? "red" : "none"}
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect opacity="0.01" width="125" height="49" fill="#010202" />
            <path
              d="M64.9586 18.0575H60.064C59.5169 18.0575 59.0034 17.8159 58.6848 17.4087L52.5385 9.55227C51.7459 8.53914 50 9.0525 50 10.2987V32.5679C50 32.8065 50.2113 33 50.472 33H53.6647C54.4286 33 55.0479 32.433 55.0479 31.7337V26.4481C57.4851 26.4481 59.6962 27.7557 60.6983 29.7897L60.7623 29.9198C61.0753 30.555 61.7658 30.9634 62.527 30.9634H62.5807C63.2763 30.9634 63.9073 30.5903 64.1933 30.0098L64.3017 29.7897C65.3037 27.7557 67.5148 26.4481 69.9521 26.4481V31.7337C69.9521 32.433 70.5713 33 71.3352 33H74.528C74.7886 33 75 32.8065 75 32.5679V10.2421C75 9.00803 73.2075 8.50961 72.3247 9.60685L66.3192 17.4321C65.999 17.8256 65.4946 18.0575 64.9586 18.0575"
              stroke="#999999"
              strokeWidth="2"
            />
            <rect
              opacity="0.01"
              x="50"
              y="8"
              width="26"
              height="26"
              fill="white"
            />
            <path
              d="M51.2233 38.88V46H50.4633V40.71L48.1533 46H47.5733L45.2433 40.75L45.2533 46H44.4933V38.88H45.1733L47.8733 45.02L50.5433 38.88H51.2233ZM55.9596 46.08C55.2996 46.08 54.7263 45.9333 54.2396 45.64C53.7529 45.3467 53.3763 44.9267 53.1096 44.38C52.8496 43.8267 52.7196 43.18 52.7196 42.44C52.7196 41.6933 52.8496 41.0467 53.1096 40.5C53.3696 39.9533 53.7429 39.5333 54.2296 39.24C54.7163 38.9467 55.2929 38.8 55.9596 38.8C56.6263 38.8 57.2029 38.9467 57.6896 39.24C58.1763 39.5333 58.5496 39.9533 58.8096 40.5C59.0696 41.0467 59.1996 41.69 59.1996 42.43C59.1996 43.1767 59.0663 43.8233 58.7996 44.37C58.5396 44.9167 58.1663 45.34 57.6796 45.64C57.1929 45.9333 56.6196 46.08 55.9596 46.08ZM55.9596 45.38C56.7129 45.38 57.2996 45.1233 57.7196 44.61C58.1396 44.0967 58.3496 43.37 58.3496 42.43C58.3496 41.49 58.1396 40.7667 57.7196 40.26C57.3063 39.7533 56.7196 39.5 55.9596 39.5C55.1996 39.5 54.6096 39.7567 54.1896 40.27C53.7696 40.7767 53.5596 41.4967 53.5596 42.43C53.5596 43.37 53.7696 44.0967 54.1896 44.61C54.6096 45.1233 55.1996 45.38 55.9596 45.38ZM60.7042 38.88H61.5242V46H60.7042V38.88ZM69.3623 38.88L66.2523 46H65.5323L62.4223 38.88H63.2923L65.9023 44.96L68.5123 38.88H69.3623ZM70.255 38.88H74.755V39.56H71.065V42.04H74.555V42.73H71.065V45.32H74.755V46H70.255V38.88ZM78.2963 46.08C77.1829 46.08 76.2963 45.78 75.6363 45.18L75.9463 44.55C76.2996 44.85 76.6596 45.0633 77.0263 45.19C77.3929 45.3167 77.8196 45.38 78.3063 45.38C78.8796 45.38 79.3196 45.27 79.6263 45.05C79.9396 44.8233 80.0963 44.5067 80.0963 44.1C80.0963 43.86 80.0196 43.6667 79.8663 43.52C79.7196 43.3667 79.5229 43.2467 79.2763 43.16C79.0363 43.0733 78.7129 42.9833 78.3063 42.89C77.7596 42.77 77.3096 42.64 76.9563 42.5C76.6029 42.36 76.3163 42.16 76.0963 41.9C75.8763 41.6333 75.7663 41.2867 75.7663 40.86C75.7663 40.4533 75.8729 40.0967 76.0863 39.79C76.2996 39.4767 76.5996 39.2333 76.9863 39.06C77.3796 38.8867 77.8363 38.8 78.3563 38.8C78.8496 38.8 79.3096 38.8767 79.7363 39.03C80.1629 39.1833 80.5229 39.4067 80.8163 39.7L80.4963 40.33C80.1629 40.0433 79.8229 39.8333 79.4763 39.7C79.1363 39.5667 78.7629 39.5 78.3563 39.5C77.8029 39.5 77.3696 39.62 77.0563 39.86C76.7429 40.0933 76.5863 40.4167 76.5863 40.83C76.5863 41.19 76.7229 41.46 76.9963 41.64C77.2696 41.82 77.6896 41.9767 78.2563 42.11C78.8696 42.2567 79.3496 42.3933 79.6963 42.52C80.0496 42.64 80.3429 42.8267 80.5763 43.08C80.8096 43.3267 80.9263 43.6567 80.9263 44.07C80.9263 44.47 80.8196 44.8233 80.6063 45.13C80.3929 45.43 80.0863 45.6633 79.6863 45.83C79.2929 45.9967 78.8296 46.08 78.2963 46.08Z"
              fill={movieActive ? "red" : "#999999"}
            />
          </svg>
        </div>
        <div className="tv-tab">
          <svg
            width="125"
            height="49"
            viewBox="0 0 125 49"
            fill={tvActive ? `red` : "none"}
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect opacity="0.01" width="125" height="49" fill="#010202" />
            <rect
              x="51"
              y="10"
              width="24"
              height="18"
              rx="2"
              stroke="#999999"
              strokeWidth="2"
            />
            <rect
              x="56"
              y="13"
              width="4"
              height="2"
              transform="rotate(90 56 13)"
              fill="#999999"
            />
            <rect
              x="59"
              y="13"
              width="2"
              height="2"
              transform="rotate(90 59 13)"
              fill="#999999"
            />
            <rect x="55" y="30" width="16" height="2" fill="#999999" />
            <rect
              opacity="0.01"
              x="50"
              y="8"
              width="26"
              height="26"
              fill="white"
            />
            <path
              d="M58.0033 39.58H55.5233V38.88H61.3133V39.58H58.8333V46H58.0033V39.58ZM68.584 38.88L65.474 46H64.754L61.644 38.88H62.514L65.124 44.96L67.734 38.88H68.584Z"
              fill={tvActive ? "red" : "#999999"}
            />
          </svg>
        </div>
        <div className="profile-tab">
          <svg
            width="125"
            height="49"
            viewBox="0 0 125 49"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <rect opacity="0.01" width="125" height="49" fill="#010202" />
            <path
              d="M65.6336 15.2655L66.4317 15.8682L66.4401 15.857L66.4482 15.8457L65.6336 15.2655ZM69.7749 9.45092L68.9736 8.85262L68.9669 8.86164L68.9603 8.87081L69.7749 9.45092ZM71.6197 22.2027H70.6197V22.7444L71.0735 23.0403L71.6197 22.2027ZM75 33V34H76V33H75ZM51 33H50V34H51V33ZM54.3803 22.2027L54.9265 23.0403L55.3803 22.7444V22.2027H54.3803ZM56.1307 9.41037L55.3215 9.99788L55.3215 9.99788L56.1307 9.41037ZM60.3691 15.2481L59.5599 15.8356L59.56 15.8357L60.3691 15.2481ZM64.6954 14.7302H61.3202V16.7302H64.6954V14.7302ZM64.8356 14.6629C64.8057 14.7025 64.7546 14.7302 64.6954 14.7302V16.7302C65.3754 16.7302 66.02 16.4133 66.4317 15.8682L64.8356 14.6629ZM68.9603 8.87081L64.8191 14.6854L66.4482 15.8457L70.5894 10.031L68.9603 8.87081ZM72.6197 9.92292C72.6197 8.94635 71.9406 8.27813 71.1893 8.07273C70.4336 7.86612 69.5397 8.0945 68.9736 8.85262L70.5761 10.0492C70.5923 10.0276 70.6051 10.0169 70.6122 10.0118C70.6195 10.0066 70.6252 10.0041 70.6296 10.0026C70.6395 9.99939 70.6516 9.99912 70.6619 10.0019C70.673 10.005 70.6641 10.0062 70.6479 9.98672C70.6393 9.97634 70.6311 9.96275 70.6255 9.94745C70.6198 9.93176 70.6197 9.92207 70.6197 9.92292H72.6197ZM72.6197 22.2027V9.92292H70.6197V22.2027H72.6197ZM71.0735 23.0403C72.8375 24.1905 74 26.1781 74 28.4366H76C76 25.4739 74.4721 22.8686 72.1659 21.365L71.0735 23.0403ZM74 28.4366V33H76V28.4366H74ZM75 32H51V34H75V32ZM52 33V28.4366H50V33H52ZM52 28.4366C52 26.1781 53.1625 24.1905 54.9265 23.0403L53.8341 21.365C51.5279 22.8686 50 25.4739 50 28.4366H52ZM53.3803 9.96499V22.2027H55.3803V9.96499H53.3803ZM56.94 8.82286C55.8423 7.31101 53.3803 8.03927 53.3803 9.96499H55.3803C55.3803 9.95887 55.381 9.96297 55.3774 9.97334C55.374 9.98335 55.3686 9.99286 55.3627 10.0004C55.3519 10.0141 55.3461 10.0135 55.3526 10.0114C55.3591 10.0094 55.3574 10.0124 55.3453 10.0088C55.3383 10.0068 55.3308 10.0032 55.3242 9.99864C55.3173 9.99381 55.317 9.99164 55.3215 9.99788L56.94 8.82286ZM61.1783 14.6606L56.94 8.82286L55.3215 9.99788L59.5599 15.8356L61.1783 14.6606ZM61.3202 14.7302C61.2598 14.7302 61.2079 14.7014 61.1783 14.6605L59.56 15.8357C59.9697 16.4 60.626 16.7302 61.3202 16.7302V14.7302Z"
              fill={profileActive ? "red" : "#999999"}
            />
            <rect
              opacity="0.01"
              x="50"
              y="8"
              width="26"
              height="26"
              fill="white"
            />
            <path
              d="M43.548 38.88H46.388C47.1213 38.88 47.6913 39.0567 48.098 39.41C48.5113 39.7633 48.718 40.25 48.718 40.87C48.718 41.49 48.5113 41.98 48.098 42.34C47.6846 42.6933 47.1146 42.87 46.388 42.87H44.368V46H43.548V38.88ZM46.318 42.19C46.8446 42.19 47.2413 42.0767 47.508 41.85C47.7746 41.6233 47.908 41.2967 47.908 40.87C47.908 40.4433 47.7746 40.12 47.508 39.9C47.2413 39.6733 46.8446 39.56 46.318 39.56H44.368V42.19H46.318ZM55.6516 46H54.7816L53.9016 43.63C53.795 43.3367 53.645 43.14 53.4516 43.04C53.265 42.94 52.9983 42.89 52.6516 42.89H50.8716V46H50.0616V38.88H52.8916C53.6583 38.88 54.245 39.05 54.6516 39.39C55.065 39.73 55.2716 40.22 55.2716 40.86C55.2716 41.3267 55.1483 41.72 54.9016 42.04C54.6616 42.3533 54.3116 42.5767 53.8516 42.71C54.0583 42.7433 54.235 42.8333 54.3816 42.98C54.5283 43.12 54.6516 43.3233 54.7516 43.59L55.6516 46ZM52.8216 42.21C53.915 42.21 54.4616 41.7633 54.4616 40.87C54.4616 40.43 54.3283 40.1033 54.0616 39.89C53.795 39.67 53.3816 39.56 52.8216 39.56H50.8716V42.21H52.8216ZM59.9264 46.08C59.2664 46.08 58.6931 45.9333 58.2064 45.64C57.7197 45.3467 57.3431 44.9267 57.0764 44.38C56.8164 43.8267 56.6864 43.18 56.6864 42.44C56.6864 41.6933 56.8164 41.0467 57.0764 40.5C57.3364 39.9533 57.7097 39.5333 58.1964 39.24C58.6831 38.9467 59.2597 38.8 59.9264 38.8C60.5931 38.8 61.1697 38.9467 61.6564 39.24C62.1431 39.5333 62.5164 39.9533 62.7764 40.5C63.0364 41.0467 63.1664 41.69 63.1664 42.43C63.1664 43.1767 63.0331 43.8233 62.7664 44.37C62.5064 44.9167 62.1331 45.34 61.6464 45.64C61.1597 45.9333 60.5864 46.08 59.9264 46.08ZM59.9264 45.38C60.6797 45.38 61.2664 45.1233 61.6864 44.61C62.1064 44.0967 62.3164 43.37 62.3164 42.43C62.3164 41.49 62.1064 40.7667 61.6864 40.26C61.2731 39.7533 60.6864 39.5 59.9264 39.5C59.1664 39.5 58.5764 39.7567 58.1564 40.27C57.7364 40.7767 57.5264 41.4967 57.5264 42.43C57.5264 43.37 57.7364 44.0967 58.1564 44.61C58.5764 45.1233 59.1664 45.38 59.9264 45.38ZM64.671 38.88H69.071V39.57H65.481V42.04H68.871V42.73H65.481V46H64.671V38.88ZM70.3058 38.88H71.1258V46H70.3058V38.88ZM72.8839 38.88H73.7039V45.3H77.2739V46H72.8839V38.88ZM78.3331 38.88H82.8331V39.56H79.1431V42.04H82.6331V42.73H79.1431V45.32H82.8331V46H78.3331V38.88Z"
              fill={profileActive ? "red" : "#999999"}
            />
          </svg>
        </div>
      </div>
    </footer>
  );
};

export default React.memo(Footer);
